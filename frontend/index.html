<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Sonos Auth Demo</title>
</head>
<body>
  <h1>Connect Your Sonos</h1>
  <button id="loginBtn">Enable Sonos Integration</button>

 <script>
  const REDIRECT_URI = "https://khaisonoscontrol.onrender.com/redirected.html";
  const state = Math.random().toString(36).substring(2);

  document.getElementById("loginBtn").addEventListener("click", async () => {
    const res = await fetch("/auth-url", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ redirect_uri: REDIRECT_URI, state })
    });
    const data = await res.json();
    window.location.href = data.url;
  });
</script>

</body>
</html>
